## 5. State Machine Diagram

이 장은 시스템의 State Machine Diagram을 제시하고, 사용자 관점에서 서비스의 주요 상태 전환 흐름을 설명한다.

<br>

![그림 5-1 State Machine Diagram](State_machine_diagram.png)  
**[그림 5-1] State Machine Diagram**

<br>

본 상태 다이어그램은 사용자가 웹 서비스 내에서  
**회원가입 → 로그인 → 홈 진입 → 게임메이트 탐색(서비스/추천) → 결제 및 코인 관리(충전/환불) → 매칭 신청 → 메이트의 수락/거절 → 알림 확인 → 매칭 종료 및 리뷰 작성 → 로그아웃**  
으로 이어지는 전체 과정을 **상태(State)**와 **상태 전이(Transition)**를 통해 표현하였다.  

각 기능은 독립된 서브 상태(Substate)로 구성되며, 사용자의 행위(클릭, 입력, 토글, 결제 등)에 따라 상태가 전환된다.

---

### (1) 회원가입 및 로그인 단계

초기 상태는 비회원 상태이며 로그인 화면으로 진입한다.  
로그인 화면에서 **회원가입**을 선택하면 `회원가입 진행` 상태로 이동하며,  
정보 입력 및 검증을 반복하여 가입 조건을 충족하면 `회원가입 완료` 후 다시 로그인 화면으로 복귀한다.  

로그인 시도는 비밀번호 오류·계정 미존재 등 예외 처리 후 다시 입력 상태를 반복한다.  
로그인 성공 시 세션 정보가 활성화되며 `홈(Home)` 상태로 전이된다.

---

### (2) 홈(Home)

로그인 직후 진입하는 기본 상태이며, 사용자는 홈에서 다음 기능으로 이동할 수 있다.  

- **서비스(게임 메이트 검색 메뉴)** 진입  
- **추천 유저 목록** 열람  
- **알림 목록** 확인  
- **게임메이트 상세**(카드 클릭) 진입  
- **마이페이지** 이동  

홈은 네비게이션 허브 관점의 상태이며, 선택한 기능에 따라 상태가 전환된다.

---

### (3) 마이페이지(Mypage)

마이페이지 진입 시 다음과 같은 서브 상태를 갖는다.

- **프로필 관리**
- **게임 메이트 등록/수정**
- **매칭 내역 조회**
- **코인 및 결제 내역 관리(충전/환불 포함)**
- **즐겨찾기 내역 조회**

결제 수행 또는 환불 처리 이후 다시 결제 내역 화면으로 복귀한다.  

즐겨찾기에서 특정 메이트 선택 시 **게임메이트 상세** 상태로 이동한다.

**게임 메이트 등록**은 매칭을 위해서 필요한 상태이다.

---

### (4) 게임메이트 검색 및 추천 유저

홈 화면에서 **서비스**를 클릭하면 서비스 메뉴 상태가 되고,  
사용자는 제공 중인 게임 중 하나를 선택하여 해당 게임 메이트 목록 상태로 진입한다.  

목록 상태에서는 필터링 또는 정렬을 수행하여 동일 상태에서 결과만 갱신하며,  
특정 메이트 카드를 선택하면 게임메이트 상세 페이지로 이동한다.

추천 유저 기능 또한 추천 목록 화면에서 카드 선택을 통해 동일하게 상세 상태로 전환된다.

---

### (5) 게임메이트 상세 & 즐겨찾기 관리

게임메이트 상세 페이지는 서비스 목록, 추천 목록, 즐겨찾기 내역 등  
여러 경로에서 진입될 수 있는 핵심 상태이다.

상세 화면에서 즐겨찾기 버튼을 클릭하면  
내부적으로 즐겨찾기 등록/해제 처리 후 다시 동일 상세 화면에 머문다.  
즐겨찾기 후 별도의 관리 화면으로 이동하지 않으며,  
즐겨찾기 목록 확인은 마이페이지에서 수행한다.

---

### (6) 매칭 신청

상세 화면에서 **매칭 신청** 버튼을 선택하면 `매칭신청 작성` 상태로 전환되어  
희망 조건 확인 및 신청을 진행한다.

매칭 신청 시 잔여 코인이 부족한 경우, 매칭 진행이 차단되고  
`결제 내역` 상태로 이동하여 코인을 충전하거나 환불을 확인할 수 있다.  
충전이 완료되면 사용자는 다시 상세 화면 또는 매칭 신청 화면으로 복귀할 수 있다.

잔여 코인이 충분할 경우 `매칭 대기` 상태로 전이되며,  
이 순간 “매칭 요청” 알림이 자동으로 생성되어 알림 목록에 기록된다.

---

### (7) 매칭 수락 및 거절 (알림 통합 처리 방식)

`매칭 대기` 상태에서 메이트는 요청을 확인하여  
다음 중 하나의 결과를 시스템에 전달한다.

- **수락** → `매칭 수락됨` 상태로 전이되며  
  “매칭 수락” 알림이 생성되어 신청자 알림 목록에 기록된다.

- **거절** → `매칭 거절됨` 상태로 전이되며  
  “매칭 거절” 알림이 생성된다.

- **매칭 요청** → `매칭 요청됨` 상태로 전이되며  
  “매칭 요청” 알림이 생성된다.

본 시스템에서 매칭 요청/수락/거절에 대한 모든 이벤트의  
**마지막 전이는 “알림 생성”으로 통일**된다.  

사용자가 알림 목록에서 특정 알림을 선택하면 해당 매칭 내역 상세 페이지로 이동한다.

---

### (8) 매칭 종료 및 리뷰 작성

메이트가 수락하여 매칭이 확정된 이후 실제 게임이 진행되고 일정이 종료되면  
`매칭 종료` 상태로 전환되며, 사용자에게 리뷰 작성 옵션이 제공된다.  

리뷰 작성은 `리뷰 작성` 상태에서 별점 및 코멘트를 입력하며,  
저장 성공 시 다시 게임메이트 상세 화면으로 복귀하여  
갱신된 누적 평점을 확인할 수 있다.

---

### (9) 알림(Notification)

알림 목록은 매칭 요청/수락/거절 이벤트에 의해 생성된 항목을 관리한다.  
알림 클릭 시 관련된 매칭 내역 또는 상세 화면으로 전환되며, 동시에 알람은 삭제된다.
알림 확인 후 사용자는 다시 홈 또는 직전 상태로 이동할 수 있다.

---

### (10) 로그아웃

사용자가 로그아웃을 선택하면 모든 세션이 종료되고  
초기 상태(로그인 화면)로 되돌아간다.

---
